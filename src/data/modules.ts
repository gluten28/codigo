export interface Lesson {
  id: string;
  title: string;
  objective: string;
  content: string;
  formulas: Formula[];
  examples: Example[];
  templateUrl?: string;
  duration: number; // in minutes
  difficulty: 'iniciante' | 'intermedi√°rio' | 'avan√ßado';
}

export interface Formula {
  id: string;
  formula: string;
  description: string;
  example?: string;
}

export interface Example {
  id: string;
  title: string;
  description: string;
  inputs: { label: string; value: string; type: 'text' | 'number' }[];
  expectedOutput: string;
}

export interface Module {
  id: string;
  title: string;
  description: string;
  icon: string;
  lessons: Lesson[];
  color: string;
}

export const excelModules: Module[] = [
  {
    id: 'introducao',
    title: 'Cap√≠tulo 1: Introdu√ß√£o ao Excel',
    description: 'O que √© o Excel e por que √© importante para o seu trabalho',
    icon: 'üöÄ',
    color: 'from-blue-500 to-blue-600',
    lessons: [
      {
        id: 'o-que-e-excel',
        title: 'O que √© o Excel e por que √© importante?',
        objective: 'Compreender a import√¢ncia e aplica√ß√µes do Excel no mundo profissional',
        content: `O Microsoft Excel √© uma das ferramentas mais poderosas e vers√°teis para an√°lise de dados, c√°lculos e cria√ß√£o de relat√≥rios. 

**Por que aprender Excel?**
- Ferramenta essencial no mercado de trabalho
- Permite an√°lise r√°pida de dados
- Automatiza c√°lculos complexos
- Cria visualiza√ß√µes profissionais

O Excel est√° presente em praticamente todas as √°reas profissionais, desde contabilidade at√© marketing digital.`,
        formulas: [],
        examples: [],
        duration: 8,
        difficulty: 'iniciante'
      },
      {
        id: 'interface-excel',
        title: 'Navegando na Interface do Excel',
        objective: 'Conhecer os elementos principais da interface do Excel',
        content: `A interface do Excel √© composta por v√°rios elementos importantes:

**Faixa de Op√ß√µes**: Cont√©m as ferramentas organizadas em separadores (In√≠cio, Inserir, Layout da P√°gina, etc.)

**Barra de F√≥rmulas**: Mostra o conte√∫do da c√©lula selecionada

**√Årea de Trabalho**: Onde ficam as c√©lulas organizadas em linhas e colunas

**Barra de Estado**: Mostra informa√ß√µes sobre a sele√ß√£o atual

*Dica visual: consulte a Fig.1 no material para melhor compreens√£o da interface.*`,
        formulas: [],
        examples: [],
        duration: 10,
        difficulty: 'iniciante'
      }
    ]
  },
  {
    id: 'fundamentos',
    title: 'Cap√≠tulo 2: Fundamentos das Planilhas',
    description: 'Entendendo c√©lulas, linhas e colunas',
    icon: 'üìä',
    color: 'from-green-500 to-green-600',
    lessons: [
      {
        id: 'celulas-linhas-colunas',
        title: 'Entendendo C√©lulas, Linhas e Colunas',
        objective: 'Dominar a estrutura b√°sica das planilhas Excel',
        content: `Uma planilha Excel √© composta por uma grade de c√©lulas organizadas em:

**Colunas**: Identificadas por letras (A, B, C...)
**Linhas**: Identificadas por n√∫meros (1, 2, 3...)
**C√©lulas**: Intersec√ß√£o de uma coluna e linha (A1, B2, C3...)

Cada c√©lula pode conter:
- N√∫meros
- Texto
- F√≥rmulas
- Datas

*Dica visual: consulte a Fig.4 para visualiza√ß√£o da grade de c√©lulas.*`,
        formulas: [],
        examples: [],
        duration: 12,
        difficulty: 'iniciante'
      },
      {
        id: 'inserindo-dados',
        title: 'Inserindo, Excluindo e Movendo Dados',
        objective: 'Aprender a manipular dados b√°sicos nas c√©lulas',
        content: `Opera√ß√µes b√°sicas com dados:

**Inserir dados**: Clique numa c√©lula e digite
**Editar dados**: Duplo clique na c√©lula ou pressione F2
**Excluir dados**: Selecione a c√©lula e pressione Delete
**Mover dados**: Cortar (Ctrl+X) e Colar (Ctrl+V)

**Formata√ß√£o b√°sica**:
- Negrito: Ctrl+B
- It√°lico: Ctrl+I
- Sublinhado: Ctrl+U`,
        formulas: [],
        examples: [],
        duration: 15,
        difficulty: 'iniciante'
      }
    ]
  },
  {
    id: 'formulas',
    title: 'Cap√≠tulo 3: F√≥rmulas e Fun√ß√µes Essenciais',
    description: 'SOMA, M√âDIA, M√ÅXIMO, M√çNIMO, SE e muito mais',
    icon: 'üßÆ',
    color: 'from-purple-500 to-purple-600',
    lessons: [
      {
        id: 'introducao-formulas',
        title: 'Introdu√ß√£o √†s F√≥rmulas do Excel',
        objective: 'Compreender como funcionam as f√≥rmulas no Excel',
        content: `As f√≥rmulas s√£o o cora√ß√£o do Excel. Sempre come√ßam com = ou +

**F√≥rmulas b√°sicas**:
- =A1+B1 (soma duas c√©lulas)
- =A1*B1 (multiplica duas c√©lulas)
- =A1/B1 (divide duas c√©lulas)

**Refer√™ncias**:
- **Relativas**: A1 (muda ao copiar)
- **Absolutas**: $A$1 (n√£o muda ao copiar)`,
        formulas: [
          {
            id: 'formula-basica',
            formula: '=A1+B1',
            description: 'Soma simples entre duas c√©lulas',
            example: 'Se A1=5 e B1=3, resultado ser√° 8'
          }
        ],
        examples: [],
        duration: 10,
        difficulty: 'iniciante'
      },
      {
        id: 'funcoes-essenciais',
        title: 'Fun√ß√µes: SOMA, M√âDIA, M√ÅXIMO, M√çNIMO, SE',
        objective: 'Dominar as fun√ß√µes mais utilizadas no Excel',
        content: `**Fun√ß√µes matem√°ticas essenciais**:

**SOMA**: =SOMA(A1:A10) - Soma todos os valores do intervalo
**M√âDIA**: =M√âDIA(A1:A10) - Calcula a m√©dia dos valores
**M√ÅXIMO**: =M√ÅXIMO(A1:A10) - Encontra o maior valor
**M√çNIMO**: =M√çNIMO(A1:A10) - Encontra o menor valor

**Fun√ß√£o SE**: =SE(A1>100;"Aprovado";"Reprovado")
Permite criar l√≥gica condicional nas c√©lulas.

*Dica visual: consulte a Fig.5 para exemplo de c√°lculo de soma.*`,
        formulas: [
          {
            id: 'soma-intervalo',
            formula: '=SOMA(A1:A10)',
            description: 'Soma todos os valores de A1 at√© A10',
            example: 'Soma automaticamente todos os n√∫meros do intervalo'
          },
          {
            id: 'funcao-se',
            formula: '=SE(A1>100;"Aprovado";"Reprovado")',
            description: 'Aprova se valor maior que 100',
            example: 'Se A1=150, resultado ser√° "Aprovado"'
          },
          {
            id: 'cont-se',
            formula: '=CONT.SE(A1:A10;">50")',
            description: 'Conta quantas c√©lulas s√£o maiores que 50',
            example: '√ötil para contar crit√©rios espec√≠ficos'
          }
        ],
        examples: [
          {
            id: 'analise-vendas',
            title: 'An√°lise de Vendas Mensais',
            description: 'Calcular estat√≠sticas de vendas',
            inputs: [
              { label: 'Janeiro', value: '15000', type: 'number' },
              { label: 'Fevereiro', value: '18000', type: 'number' },
              { label: 'Mar√ßo', value: '12000', type: 'number' }
            ],
            expectedOutput: 'Total: 45000, M√©dia: 15000'
          }
        ],
        duration: 20,
        difficulty: 'intermedi√°rio'
      }
    ]
  },
  {
    id: 'gerenciamento',
    title: 'Cap√≠tulo 4: Gerenciamento de Dados',
    description: 'Ordenar, filtrar e validar dados eficientemente',
    icon: 'üóÇÔ∏è',
    color: 'from-indigo-500 to-indigo-600',
    lessons: [
      {
        id: 'ordenar-filtrar',
        title: 'Ordenando e Filtrando Dados',
        objective: 'Organizar e visualizar dados de forma eficiente',
        content: `**Ordenar dados**:
1. Selecione os dados
2. V√° em Dados > Ordenar
3. Escolha a coluna e ordem (crescente/decrescente)

**Filtrar dados**:
1. Selecione os dados
2. Pressione Ctrl+Shift+L ou v√° em Dados > Filtro
3. Clique nas setas dos cabe√ßalhos para filtrar

*Dica visual: consulte a Fig.6 para configura√ß√£o de ordena√ß√£o.*

**Filtros autom√°ticos** permitem ver apenas os dados que atendem a crit√©rios espec√≠ficos.`,
        formulas: [],
        examples: [],
        duration: 15,
        difficulty: 'intermedi√°rio'
      },
      {
        id: 'validacao-dados',
        title: 'Valida√ß√£o de Dados e Listas Suspensas',
        objective: 'Controlar a entrada de dados e criar listas dropdown',
        content: `**Valida√ß√£o de dados** evita erros de entrada:

1. Selecione as c√©lulas
2. V√° em Dados > Valida√ß√£o de Dados
3. Defina crit√©rios (n√∫mero, data, lista, etc.)

**Listas suspensas**:
- Tipo: Lista
- Fonte: =A1:A10 ou digite valores separados por ponto e v√≠rgula

**Ferramentas de pesquisa**:
- **Localizar**: Ctrl+F
- **Substituir**: Ctrl+H`,
        formulas: [],
        examples: [],
        duration: 18,
        difficulty: 'intermedi√°rio'
      }
    ]
  },
  {
    id: 'graficos',
    title: 'Cap√≠tulo 5: Gr√°ficos Simples e Visuais',
    description: 'Criar visualiza√ß√µes profissionais dos seus dados',
    icon: 'üìà',
    color: 'from-pink-500 to-pink-600',
    lessons: [
      {
        id: 'graficos-basicos',
        title: 'Criando Gr√°ficos B√°sicos',
        objective: 'Transformar dados em visualiza√ß√µes claras e profissionais',
        content: `**Tipos de gr√°ficos mais utilizados**:

**Gr√°fico de Colunas**: Ideal para comparar valores
**Gr√°fico de Linhas**: Perfeito para mostrar tend√™ncias ao longo do tempo
**Gr√°fico de Pizza**: Excelente para mostrar propor√ß√µes

*Dica visual: consulte a Fig.7 para exemplo de gr√°fico de pizza.*

**Como criar**:
1. Selecione os dados
2. V√° em Inserir > Gr√°ficos
3. Escolha o tipo apropriado`,
        formulas: [],
        examples: [],
        duration: 12,
        difficulty: 'iniciante'
      },
      {
        id: 'personalizar-graficos',
        title: 'Personalizando Gr√°ficos',
        objective: 'Deixar seus gr√°ficos mais atrativos e profissionais',
        content: `**Op√ß√µes de personaliza√ß√£o**:

- **T√≠tulo**: Adicione t√≠tulos descritivos
- **Cores**: Escolha paletas profissionais
- **Legendas**: Posicione adequadamente
- **Eixos**: Configure escalas e r√≥tulos

*Dica visual: consulte as Fig.8-13 para op√ß√µes de design e tipos.*

**Tipos dispon√≠veis**:
- Barras (Fig.9)
- Linhas (Fig.10)  
- Pizza (Fig.11)
- Dispers√£o (Fig.12)
- Grelha de op√ß√µes (Fig.13)`,
        formulas: [],
        examples: [],
        duration: 15,
        difficulty: 'intermedi√°rio'
      }
    ]
  },
  {
    id: 'tabelas-dinamicas',
    title: 'Cap√≠tulo 6: Trabalhando com Tabelas Din√¢micas',
    description: 'An√°lise poderosa de grandes volumes de dados',
    icon: 'üîÑ',
    color: 'from-orange-500 to-orange-600',
    lessons: [
      {
        id: 'introducao-tabelas-dinamicas',
        title: 'Introdu√ß√£o √†s Tabelas Din√¢micas',
        objective: 'Compreender o poder das tabelas din√¢micas para an√°lise',
        content: `**Tabelas Din√¢micas** s√£o uma das ferramentas mais poderosas do Excel:

- Resumem grandes quantidades de dados
- Permitem an√°lises r√°pidas e flex√≠veis
- Criam relat√≥rios profissionais automaticamente
- Facilitam a identifica√ß√£o de padr√µes

**Quando usar**:
- An√°lise de vendas por regi√£o
- Relat√≥rios financeiros
- Controle de estoque
- An√°lise de performance`,
        formulas: [],
        examples: [],
        duration: 10,
        difficulty: 'intermedi√°rio'
      },
      {
        id: 'criando-tabelas-dinamicas',
        title: 'Criando e Personalizando Tabelas Din√¢micas',
        objective: 'Criar relat√≥rios din√¢micos arrastando campos',
        content: `**Como criar uma tabela din√¢mica**:

1. Selecione seus dados
2. V√° em Inserir > Tabela Din√¢mica
3. Arraste campos para as √°reas:
   - **Linhas**: Categorias principais
   - **Colunas**: Subcategorias
   - **Valores**: Dados num√©ricos a serem analisados
   - **Filtros**: Crit√©rios de filtro

**Dica importante**: Os dados devem estar organizados em formato tabular com cabe√ßalhos.`,
        formulas: [],
        examples: [],
        duration: 20,
        difficulty: 'avan√ßado'
      }
    ]
  },
  {
    id: 'macros',
    title: 'Cap√≠tulo 7: Automatizando Tarefas com Macros',
    description: 'Automatize tarefas repetitivas e ganhe produtividade',
    icon: 'ü§ñ',
    color: 'from-teal-500 to-teal-600',
    lessons: [
      {
        id: 'o-que-sao-macros',
        title: 'O que s√£o Macros?',
        objective: 'Entender como as macros podem automatizar seu trabalho',
        content: `**Macros** s√£o sequ√™ncias de comandos gravados que podem ser executados automaticamente:

- Automatizam tarefas repetitivas
- Poupam tempo significativo
- Reduzem erros humanos
- Aumentam a produtividade

**Exemplos pr√°ticos**:
- Formata√ß√£o autom√°tica de relat√≥rios
- C√°lculos complexos recorrentes
- Organiza√ß√£o de dados
- Cria√ß√£o de bot√µes personalizados`,
        formulas: [],
        examples: [],
        duration: 8,
        difficulty: 'avan√ßado'
      },
      {
        id: 'gravando-macros',
        title: 'Gravando e Executando Macros Simples',
        objective: 'Criar suas primeiras automatiza√ß√µes no Excel',
        content: `**Como gravar uma macro**:

1. V√° em Desenvolvedor > Gravar Macro
2. D√™ um nome √† macro
3. Execute as a√ß√µes que deseja automatizar
4. Pare a grava√ß√£o

**Exemplo pr√°tico**: Criar bot√£o "Atualizar"
- Grave as a√ß√µes de atualiza√ß√£o
- Crie um bot√£o na planilha
- Associe a macro ao bot√£o

**Atalho √∫til**: Alt+F8 para executar macros`,
        formulas: [],
        examples: [],
        duration: 15,
        difficulty: 'avan√ßado'
      }
    ]
  },
  {
    id: 'texto-avancado',
    title: 'Cap√≠tulo 8: Fun√ß√µes de Texto Avan√ßadas',
    description: 'CONCATENAR, VLOOKUP/PROCV e manipula√ß√£o de texto',
    icon: 'üìù',
    color: 'from-cyan-500 to-cyan-600',
    lessons: [
      {
        id: 'funcoes-texto-intro',
        title: 'Introdu√ß√£o √†s Fun√ß√µes de Texto',
        objective: 'Dominar a manipula√ß√£o e limpeza de dados de texto',
        content: `**Fun√ß√µes de texto essenciais**:

- **MAI√öSCULA**: Converte texto para mai√∫sculas
- **MIN√öSCULA**: Converte texto para min√∫sculas  
- **PRI.MAI√öSCULA**: Primeira letra mai√∫scula
- **ESQUERDA/DIREITA**: Extrai caracteres espec√≠ficos
- **SUBSTITUIR**: Troca texto automaticamente

Estas fun√ß√µes s√£o fundamentais para limpeza e organiza√ß√£o de dados textuais.`,
        formulas: [
          {
            id: 'maiuscula',
            formula: '=MAI√öSCULA(A1)',
            description: 'Converte texto para mai√∫sculas',
            example: '"jo√£o" torna-se "JO√ÉO"'
          },
          {
            id: 'esquerda',
            formula: '=ESQUERDA(A1;3)',
            description: 'Extrai 3 caracteres da esquerda',
            example: '"Excel" retorna "Exc"'
          }
        ],
        examples: [],
        duration: 12,
        difficulty: 'intermedi√°rio'
      },
      {
        id: 'concatenar-procv',
        title: 'Fun√ß√£o CONCATENAR e VLOOKUP/PROCV',
        objective: 'Juntar textos e fazer pesquisas avan√ßadas',
        content: `**Fun√ß√£o CONCATENAR**: Junta textos de v√°rias c√©lulas

Exemplo: =CONCATENAR(C5;" ";D1)
Se C5="Jo√£o" e D1="Silva", resultado ser√° "Jo√£o Silva"

**Fun√ß√£o VLOOKUP/PROCV**: Pesquisa valores em tabelas

Sintaxe: =PROCV(valor_procurado; matriz_tabela; n√∫m_√≠ndice_col; FALSO)

**Exemplo pr√°tico**: 
Procurar ID 102 numa tabela de produtos para retornar "Mouse"
=PROCV(102;A:C;2;FALSO)

Esta fun√ß√£o √© essencial para cruzar dados entre tabelas.`,
        formulas: [
          {
            id: 'concatenar-exemplo',
            formula: '=CONCATENAR(A1;" ";B1)',
            description: 'Junta nome e sobrenome com espa√ßo',
            example: 'A1="Maria", B1="Santos" = "Maria Santos"'
          },
          {
            id: 'procv-exemplo',
            formula: '=PROCV(A1;Tabela!A:C;2;FALSO)',
            description: 'Procura valor em tabela e retorna da coluna 2',
            example: 'Busca ID e retorna nome correspondente'
          }
        ],
        examples: [
          {
            id: 'busca-produto',
            title: 'Busca de Produto por ID',
            description: 'Encontrar nome do produto usando ID',
            inputs: [
              { label: 'ID do Produto', value: '102', type: 'number' }
            ],
            expectedOutput: 'Produto: Mouse'
          }
        ],
        duration: 18,
        difficulty: 'avan√ßado'
      }
    ]
  }
];

// Fun√ß√£o para buscar li√ß√µes
export const searchLessons = (query: string): Lesson[] => {
  const results: Lesson[] = [];
  const queryLower = query.toLowerCase();
  
  excelModules.forEach(module => {
    module.lessons.forEach(lesson => {
      if (
        lesson.title.toLowerCase().includes(queryLower) ||
        lesson.content.toLowerCase().includes(queryLower) ||
        lesson.objective.toLowerCase().includes(queryLower)
      ) {
        results.push(lesson);
      }
    });
  });
  
  return results;
};

// Fun√ß√£o para obter progresso do m√≥dulo
export const getModuleProgress = (moduleId: string): number => {
  const completedLessons = JSON.parse(localStorage.getItem('completedLessons') || '[]');
  const module = excelModules.find(m => m.id === moduleId);
  
  if (!module) return 0;
  
  const totalLessons = module.lessons.length;
  const completedCount = module.lessons.filter(lesson => 
    completedLessons.includes(lesson.id)
  ).length;
  
  return Math.round((completedCount / totalLessons) * 100);
};